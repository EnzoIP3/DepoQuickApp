import{a as d}from"./chunk-VUDT63JA.js";import{a as u,b as c,c as f,d as q}from"./chunk-SVEYEHT4.js";import"./chunk-TDDMEX7Y.js";import{a as D}from"./chunk-UF6I3TVD.js";import{a as G}from"./chunk-L6TZS5FK.js";import"./chunk-FBSXW3BF.js";import"./chunk-P47V3DL4.js";import"./chunk-FFVHMX5G.js";import{d as n,m as w}from"./chunk-3VIG4VHP.js";import{Cb as A,K as s,L as a,T as b,V as t,Xb as H,Yb as E,Za as _,aa as l,ab as L,ba as S,ca as m,cb as B,ha as C,ia as R,n as h,o as v,q as F,s as p,t as y,yb as T,zb as I}from"./chunk-2GDBKQSI.js";var O=class e{static \u0275fac=function(r){return new(r||e)};static \u0275cmp=p({type:e,selectors:[["app-auth-page"]],decls:1,vars:0,template:function(r,o){r&1&&m(0,"router-outlet")},dependencies:[T],encapsulation:2})};function Z(e,i){if(e&1&&m(0,"app-message",7),e&2){let r=R();t("text",r.loginStatus.error)}}var P=class e{constructor(i,r,o){this._formBuilder=i;this._authService=r;this._router=o}formFields={password:{required:{message:"Password is required"},minlength:{message:"Password must be at least 8 characters long"}},email:{required:{message:"Email is required"},email:{message:"Email is invalid"}}};loginForm;loginStatus={loading:!1,error:null};_loginSubscription=null;ngOnInit(){this.loginForm=this._formBuilder.group({email:["",[n.required,n.email]],password:["",[n.required,n.minLength(8)]]})}onSubmit(){this.loginStatus.loading=!0,this.loginStatus.error=null,this._loginSubscription=this._authService.login(this.loginForm.value).subscribe({next:()=>{this.loginStatus.loading=!1,this.loginForm.reset(),this._router.navigate(["/devices"])},error:i=>{this.loginStatus.loading=!1,this.loginStatus.error=i.message}})}ngOnDestroy(){this._loginSubscription&&this._loginSubscription.unsubscribe()}static \u0275fac=function(r){return new(r||e)(a(w),a(G),a(I))};static \u0275cmp=p({type:e,selectors:[["app-login-form"]],decls:7,vars:8,consts:[[1,"centered-content"],["title","Login to your account","icon","pi-sign-in",1,"mb-4","text-primary-600","text-center"],[3,"onSubmit","form"],["type","text","label","Email","placeholder","email@example.com","name","email","iconClass","pi pi-envelope",3,"form","formField"],["type","password","label","Password","placeholder","*****","name","password","iconClass","pi pi-lock",3,"form","formField"],["title","Login","color","primary",3,"loading","disabled"],["severity","error",3,"text",4,"ngIf"],["severity","error",3,"text"]],template:function(r,o){r&1&&(l(0,"div",0),m(1,"app-icon-title",1),l(2,"app-form",2),C("onSubmit",function(){return o.onSubmit()}),m(3,"app-form-input",3)(4,"app-form-input",4)(5,"app-form-button",5),b(6,Z,1,1,"app-message",6),S()()),r&2&&(s(2),t("form",o.loginForm),s(),t("form",o.loginForm)("formField",o.formFields.email),s(),t("form",o.loginForm)("formField",o.formFields.password),s(),t("loading",o.loginStatus.loading)("disabled",!o.loginForm.valid),s(),t("ngIf",o.loginStatus.error))},dependencies:[_,u,c,f,d,q],encapsulation:2})};var N=class e extends H{constructor(i,r){super(E.apiUrl,"home_owners",i,r)}register(i){return this.post(i)}static \u0275fac=function(r){return new(r||e)(F(B),F(I))};static \u0275prov=h({token:e,factory:e.\u0275fac,providedIn:"root"})};var j=class e{constructor(i){this._repository=i}register(i){return this._repository.register(i)}static \u0275fac=function(r){return new(r||e)(F(N))};static \u0275prov=h({token:e,factory:e.\u0275fac,providedIn:"root"})};function oe(e,i){e&1&&m(0,"app-message",11)}function ie(e,i){if(e&1&&m(0,"app-message",12),e&2){let r=R();t("text",r.registerStatus.error)}}var M=class e{constructor(i,r){this._formBuilder=i;this._homeOwnersService=r}formFields={firstName:{required:{message:"First name is required"}},surname:{required:{message:"Last name is required"}},profilePicture:{required:{message:"Profile picture URL is required"},pattern:{message:"Profile picture must be a valid URL"}},email:{required:{message:"Email is required"},email:{message:"Email is invalid"}},password:{required:{message:"Password is required"},minlength:{message:"Password must be at least 8 characters long"}}};registerForm;registerStatus={loading:!1,success:!1,error:null};_registerSubscription=null;ngOnInit(){this.registerForm=this._formBuilder.group({name:["",[n.required]],surname:["",[n.required]],profilePicture:["",[n.required,n.pattern(/^(http|https):\/\/[^ "]+$/)]],email:["",[n.required,n.email]],password:["",[n.required,n.minLength(8)]]})}onSubmit(){this.registerStatus.loading=!0,this.registerStatus.error=null,this.registerStatus.success=!1,this._registerSubscription=this._homeOwnersService.register(this.registerForm.value).subscribe({next:()=>{this.registerStatus.loading=!1,this.registerStatus.success=!0,this.registerForm.reset()},error:i=>{this.registerStatus.loading=!1,this.registerStatus.error=i.message}})}ngOnDestroy(){this._registerSubscription&&this._registerSubscription.unsubscribe()}static \u0275fac=function(r){return new(r||e)(a(w),a(j))};static \u0275cmp=p({type:e,selectors:[["app-register-form"]],decls:11,vars:15,consts:[[1,"centered-content"],["title","Register as a home owner","icon","pi-user-plus",1,"mb-4","text-primary-600","text-center"],[3,"onSubmit","form"],["type","text","label","First Name","placeholder","John","name","name","iconClass","pi pi-user",3,"form","formField"],["type","text","label","Last Name","placeholder","Doe","name","surname","iconClass","pi pi-user-plus",3,"form","formField"],["type","url","label","Profile Picture URL","placeholder","https://example.com/photo.jpg","name","profilePicture","iconClass","pi pi-image",3,"form","formField"],["type","text","label","Email","placeholder","email@example.com","name","email","iconClass","pi pi-envelope",3,"form","formField"],["type","password","label","Password","placeholder","*****","name","password","iconClass","pi pi-lock",3,"form","formField"],["title","Register","color","primary",3,"loading","disabled"],["text","You have successfully registered! Now you can login.","severity","success",4,"ngIf"],["severity","error",3,"text",4,"ngIf"],["text","You have successfully registered! Now you can login.","severity","success"],["severity","error",3,"text"]],template:function(r,o){r&1&&(l(0,"div",0),m(1,"app-icon-title",1),l(2,"app-form",2),C("onSubmit",function(){return o.onSubmit()}),m(3,"app-form-input",3)(4,"app-form-input",4)(5,"app-form-input",5)(6,"app-form-input",6)(7,"app-form-input",7)(8,"app-form-button",8),b(9,oe,1,0,"app-message",9)(10,ie,1,1,"app-message",10),S()()),r&2&&(s(2),t("form",o.registerForm),s(),t("form",o.registerForm)("formField",o.formFields.firstName),s(),t("form",o.registerForm)("formField",o.formFields.surname),s(),t("form",o.registerForm)("formField",o.formFields.profilePicture),s(),t("form",o.registerForm)("formField",o.formFields.email),s(),t("form",o.registerForm)("formField",o.formFields.password),s(),t("loading",o.registerStatus.loading)("disabled",!o.registerForm.valid),s(),t("ngIf",o.registerStatus.success),s(),t("ngIf",o.registerStatus.error))},dependencies:[_,u,c,f,d,q],encapsulation:2})};var te=[{path:"",component:O,children:[{path:"login",canActivate:[D],component:P},{path:"register",canActivate:[D],component:M},{path:"",redirectTo:"login",pathMatch:"full"}]}],x=class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=y({type:e});static \u0275inj=v({imports:[A.forChild(te),A]})};var V=class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=y({type:e});static \u0275inj=v({imports:[L,x,u,c,f,d]})};export{V as AuthModule};
